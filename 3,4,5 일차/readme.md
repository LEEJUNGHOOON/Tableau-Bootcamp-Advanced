[DAY 3–5] 차원의 지배자 1편: 세부 수준 계산식(LOD) — 요약

0. 핵심 한 줄

LOD는 “시트에 놓인 차원(시각화의 세부 수준)”과 무관하게, 내가 원하는 차원 수준으로 집계를 ‘고정’해 계산하는 기술입니다. 계산 수준 ≠ 시각화 수준일 때 정확한 값을 보장합니다.

⸻

1) 왜 LOD가 필요한가
	•	Tableau는 기본적으로 시트에 올린 차원(열/행/색/크기/레이블/세부정보/경로/페이지)에 맞춰 집계합니다.
	•	분석에서 계산에 필요한 수준이 시각화의 수준과 다르면 결과가 틀어집니다.

예시: “설치 → 첫 이벤트”까지 걸린 시간(고객별)
	•	고객별 최소 설치시간과 최소 이벤트시간의 차이를 계산해야 함.
	•	단순 MIN([Install]), MIN([Event])로 만든 계산을 히스토그램으로 그리려 [Customer ID]를 빼는 순간, 시각화 수준이 전체로 바뀌어 전체 최소값 차이 + 전체 카운트가 표시되는 오류 발생.
	•	해결: 고객 수준으로 값(최초 설치/이벤트)을 고정해 둔 다음, 그 결과를 소요 기간 차원으로 분포(히스토그램) 시각화.

⸻

2) LOD 작성법 (Syntax)

{ INCLUDE | EXCLUDE | FIXED [차원1], [차원2], ...
  : 집계함수( [측정값] 또는 [차원] ) }

실전 예제

// 고객별 최초 설치일
{ FIXED [Customer ID] : MIN([Install Time]) }

// 고객별 최초 이벤트일
{ FIXED [Customer ID] : MIN([Event Time]) }

// 소요 기간(주)
DATEDIFF('week', [고객별 최초 설치일], [고객별 최초 이벤트일])

	•	위처럼 FIXED로 고객 차원에 고정하면, 고객마다 하나의 값이 생성되어 이후 시각화 수준이 바뀌어도 정확성을 유지합니다.

⸻

3) FIXED / INCLUDE / EXCLUDE 차이

핵심 차이: 시각화의 세부 수준(View LOD)을 고려하는가?
	•	FIXED: 시각화 수준과 무관하게 지정 차원으로 고정해 집계
	•	예) { FIXED [제품대분류] : SUM([매출]) }
→ 중분류로 시각화해도 대분류 합계가 표시됨.
	•	EXCLUDE: 현재 뷰에 포함된 차원 중 일부 차원을 제외하고 집계
	•	예) { EXCLUDE [제품중분류] : SUM([매출]) }
→ 뷰가 대분류/중분류여도 중분류는 제외 → 대분류 수준 집계.
	•	INCLUDE: 현재 뷰의 차원에 추가 차원을 포함해 더 세분화하여 집계
	•	예) { INCLUDE [제품명] : SUM([매출]) }
→ 내부적으로 제품명 수준 합계를 만든 후, 뷰 수준(예: 중분류)에서 재집계됨.
	•	평균을 구할 때 분모가 달라질 수 있음(뷰의 행수 vs LOD 대상의 고유 개수) 점 주의.

실무 팁: 뷰 수준 영향을 피하고 싶으면 FIXED가 가장 예측 가능합니다.

⸻

4) Tableau 작업 순서(Order of Operations) 이해 (필터 우선순위)

문제 상황: Top N과 차원 필터를 함께 쓸 때 결과가 어긋남.
	•	기본 순서상 Top N이 차원 필터보다 우선 → “전체에서 Top10”을 고른 뒤, “가구” 필터를 적용하면 가구에 해당하는 일부만 남아 10개가 안 될 수 있음.

해결
	•	**차원 필터를 ‘컨텍스트 필터’**로 승격해 우선순위를 올린 뒤 Top N 적용.
	•	컨텍스트(가구) → 그 결과 집합에서 Top 10 계산
	•	메뉴: 필터 우클릭 → 컨텍스트에 추가

⸻

5) 베스트 프랙티스 & 흔한 함정
	•	계산 수준을 명시: 뷰에서 차원을 빼거나 측정값/차원 변환해도 결과가 지켜지게 LOD로 의도를 고정.
	•	INCLUDE/EXCLUDE는 뷰 의존: 뷰 차원 변경에 민감. 유지보수 관점에서 FIXED 선호.
	•	평균 계산 주의: AVG({ INCLUDE … : SUM([매출]) })는 INCLUDE 수준의 고유 개수로 나뉩니다(뷰 행수와 다를 수 있음).
	•	문서화: LOD 필드에 주석(계산 목적/수준) 남기기.
	•	성능: 과도한 LOD 남발은 비용↑. 필요한 필드만 생성/재사용.

⸻

6) 실습 포인트(과제 요지)
	•	고객별 최초 설치/이벤트를 FIXED 고객 LOD로 계산 → 소요 기간 생성 → 분포 시각화(소요 기간 차원, 고객 고유 카운트).
	•	Top N과 차원 필터 동시 사용 시, 컨텍스트 필터로 우선순위 제어.

⸻

7) 면접·이력서용 요약 문구(예시)
	•	“Tableau **LOD(FIXED/INCLUDE/EXCLUDE)**로 계산 수준을 명시하여 시각화 수준 변화에도 정확한 집계를 보장. Order of Operations와 Context Filter로 Top N·차원 필터 충돌을 해결하고, 고객별 ‘설치→첫 이벤트’ 리드타임 분포를 정확히 산출했습니다.”
